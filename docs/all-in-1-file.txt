[Skip to content](https://github.com/ropensci/aorsf#start-of-content) 

You signed in with another tab or window. [Reload](https://github.com/ropensci/aorsf) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/ropensci/aorsf) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/ropensci/aorsf) to refresh your session. Dismiss alert 

{{ message }}

[ ropensci](https://github.com/ropensci) / **[aorsf](https://github.com/ropensci/aorsf)** Public 

* [ Notifications](https://github.com/login?return%5Fto=%2Fropensci%2Faorsf) You must be signed in to change notification settings
* [ Fork11 ](https://github.com/login?return%5Fto=%2Fropensci%2Faorsf)
* [  Star 58 ](https://github.com/login?return%5Fto=%2Fropensci%2Faorsf)

 Accelerated Oblique Random Survival Forests

[docs.ropensci.org/aorsf](https://docs.ropensci.org/aorsf "https://docs.ropensci.org/aorsf") 

### License

 Unknown, MIT licenses found 

### Licenses found

[ Unknown LICENSE ](https://github.com/ropensci/aorsf/blob/main/LICENSE) [ MIT LICENSE.md ](https://github.com/ropensci/aorsf/blob/main/LICENSE.md) 

[ 58 stars](https://github.com/ropensci/aorsf/stargazers) [ 11 forks](https://github.com/ropensci/aorsf/forks) [ Branches ](https://github.com/ropensci/aorsf/branches) [ Tags ](https://github.com/ropensci/aorsf/tags) [ Activity ](https://github.com/ropensci/aorsf/activity) 

[  Star ](https://github.com/login?return%5Fto=%2Fropensci%2Faorsf)

[ Notifications](https://github.com/login?return%5Fto=%2Fropensci%2Faorsf) You must be signed in to change notification settings 

# ropensci/aorsf

main

[Branches](https://github.com/ropensci/aorsf/branches)[Tags](https://github.com/ropensci/aorsf/tags)

Go to file

Code

## Folders and files

| Name                                                                                                                       | Name                                                                                                                       | Last commit message | Last commit date |
| -------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- | ------------------- | ---------------- |
| Latest commit History[801 Commits](https://github.com/ropensci/aorsf/commits/main/)                                        |                                                                                                                            |                     |                  |
| [.github](https://github.com/ropensci/aorsf/tree/main/.github ".github")                                                   | [.github](https://github.com/ropensci/aorsf/tree/main/.github ".github")                                                   |                     |                  |
| [R](https://github.com/ropensci/aorsf/tree/main/R "R")                                                                     | [R](https://github.com/ropensci/aorsf/tree/main/R "R")                                                                     |                     |                  |
| [Rmd](https://github.com/ropensci/aorsf/tree/main/Rmd "Rmd")                                                               | [Rmd](https://github.com/ropensci/aorsf/tree/main/Rmd "Rmd")                                                               |                     |                  |
| [cache](https://github.com/ropensci/aorsf/tree/main/cache "cache")                                                         | [cache](https://github.com/ropensci/aorsf/tree/main/cache "cache")                                                         |                     |                  |
| [data-raw](https://github.com/ropensci/aorsf/tree/main/data-raw "data-raw")                                                | [data-raw](https://github.com/ropensci/aorsf/tree/main/data-raw "data-raw")                                                |                     |                  |
| [data](https://github.com/ropensci/aorsf/tree/main/data "data")                                                            | [data](https://github.com/ropensci/aorsf/tree/main/data "data")                                                            |                     |                  |
| [inst](https://github.com/ropensci/aorsf/tree/main/inst "inst")                                                            | [inst](https://github.com/ropensci/aorsf/tree/main/inst "inst")                                                            |                     |                  |
| [joss](https://github.com/ropensci/aorsf/tree/main/joss "joss")                                                            | [joss](https://github.com/ropensci/aorsf/tree/main/joss "joss")                                                            |                     |                  |
| [man](https://github.com/ropensci/aorsf/tree/main/man "man")                                                               | [man](https://github.com/ropensci/aorsf/tree/main/man "man")                                                               |                     |                  |
| [pkgdown/favicon](https://github.com/ropensci/aorsf/tree/main/pkgdown/favicon "This path skips through empty directories") | [pkgdown/favicon](https://github.com/ropensci/aorsf/tree/main/pkgdown/favicon "This path skips through empty directories") |                     |                  |
| [src](https://github.com/ropensci/aorsf/tree/main/src "src")                                                               | [src](https://github.com/ropensci/aorsf/tree/main/src "src")                                                               |                     |                  |
| [tests](https://github.com/ropensci/aorsf/tree/main/tests "tests")                                                         | [tests](https://github.com/ropensci/aorsf/tree/main/tests "tests")                                                         |                     |                  |
| [vignettes](https://github.com/ropensci/aorsf/tree/main/vignettes "vignettes")                                             | [vignettes](https://github.com/ropensci/aorsf/tree/main/vignettes "vignettes")                                             |                     |                  |
| [.Rbuildignore](https://github.com/ropensci/aorsf/blob/main/.Rbuildignore ".Rbuildignore")                                 | [.Rbuildignore](https://github.com/ropensci/aorsf/blob/main/.Rbuildignore ".Rbuildignore")                                 |                     |                  |
| [.gitignore](https://github.com/ropensci/aorsf/blob/main/.gitignore ".gitignore")                                          | [.gitignore](https://github.com/ropensci/aorsf/blob/main/.gitignore ".gitignore")                                          |                     |                  |
| [.zenodo.json](https://github.com/ropensci/aorsf/blob/main/.zenodo.json ".zenodo.json")                                    | [.zenodo.json](https://github.com/ropensci/aorsf/blob/main/.zenodo.json ".zenodo.json")                                    |                     |                  |
| [CRAN-SUBMISSION](https://github.com/ropensci/aorsf/blob/main/CRAN-SUBMISSION "CRAN-SUBMISSION")                           | [CRAN-SUBMISSION](https://github.com/ropensci/aorsf/blob/main/CRAN-SUBMISSION "CRAN-SUBMISSION")                           |                     |                  |
| [DESCRIPTION](https://github.com/ropensci/aorsf/blob/main/DESCRIPTION "DESCRIPTION")                                       | [DESCRIPTION](https://github.com/ropensci/aorsf/blob/main/DESCRIPTION "DESCRIPTION")                                       |                     |                  |
| [LICENSE](https://github.com/ropensci/aorsf/blob/main/LICENSE "LICENSE")                                                   | [LICENSE](https://github.com/ropensci/aorsf/blob/main/LICENSE "LICENSE")                                                   |                     |                  |
| [LICENSE.md](https://github.com/ropensci/aorsf/blob/main/LICENSE.md "LICENSE.md")                                          | [LICENSE.md](https://github.com/ropensci/aorsf/blob/main/LICENSE.md "LICENSE.md")                                          |                     |                  |
| [NAMESPACE](https://github.com/ropensci/aorsf/blob/main/NAMESPACE "NAMESPACE")                                             | [NAMESPACE](https://github.com/ropensci/aorsf/blob/main/NAMESPACE "NAMESPACE")                                             |                     |                  |
| [NEWS.md](https://github.com/ropensci/aorsf/blob/main/NEWS.md "NEWS.md")                                                   | [NEWS.md](https://github.com/ropensci/aorsf/blob/main/NEWS.md "NEWS.md")                                                   |                     |                  |
| [README.Rmd](https://github.com/ropensci/aorsf/blob/main/README.Rmd "README.Rmd")                                          | [README.Rmd](https://github.com/ropensci/aorsf/blob/main/README.Rmd "README.Rmd")                                          |                     |                  |
| [README.md](https://github.com/ropensci/aorsf/blob/main/README.md "README.md")                                             | [README.md](https://github.com/ropensci/aorsf/blob/main/README.md "README.md")                                             |                     |                  |
| [\_pkgdown.yml](https://github.com/ropensci/aorsf/blob/main/%5Fpkgdown.yml "_pkgdown.yml")                                 | [\_pkgdown.yml](https://github.com/ropensci/aorsf/blob/main/%5Fpkgdown.yml "_pkgdown.yml")                                 |                     |                  |
| [aorsf.Rproj](https://github.com/ropensci/aorsf/blob/main/aorsf.Rproj "aorsf.Rproj")                                       | [aorsf.Rproj](https://github.com/ropensci/aorsf/blob/main/aorsf.Rproj "aorsf.Rproj")                                       |                     |                  |
| [codecov.yml](https://github.com/ropensci/aorsf/blob/main/codecov.yml "codecov.yml")                                       | [codecov.yml](https://github.com/ropensci/aorsf/blob/main/codecov.yml "codecov.yml")                                       |                     |                  |
| [codemeta.json](https://github.com/ropensci/aorsf/blob/main/codemeta.json "codemeta.json")                                 | [codemeta.json](https://github.com/ropensci/aorsf/blob/main/codemeta.json "codemeta.json")                                 |                     |                  |
| [cran-comments.md](https://github.com/ropensci/aorsf/blob/main/cran-comments.md "cran-comments.md")                        | [cran-comments.md](https://github.com/ropensci/aorsf/blob/main/cran-comments.md "cran-comments.md")                        |                     |                  |
| [logo.png](https://github.com/ropensci/aorsf/blob/main/logo.png "logo.png")                                                | [logo.png](https://github.com/ropensci/aorsf/blob/main/logo.png "logo.png")                                                |                     |                  |
| View all files                                                                                                             |                                                                                                                            |                     |                  |

## Repository files navigation

# aorsf [![](https://github.com/ropensci/aorsf/raw/main/man/figures/logo.png)](https://docs.ropensci.org/aorsf/)

[![Project Status: Active – The project has reached a stable, usable state and is being actively developed.](https://camo.githubusercontent.com/7e20e1589fb5e2aa55bb1de94227dc006b7639c2d2e1020eb08025ffae9f61df/68747470733a2f2f7777772e7265706f7374617475732e6f72672f6261646765732f6c61746573742f6163746976652e737667)](https://www.repostatus.org/#active) [![Codecov test coverage](https://camo.githubusercontent.com/7cf551a0f8a3cdd8c26cf1d809c247ee09c7578a8bfabdc04fc4a57dda2aaa3d/68747470733a2f2f636f6465636f762e696f2f67682f62636a61656765722f616f7273662f6272616e63682f6d61737465722f67726170682f62616467652e737667)](https://app.codecov.io/gh/bcjaeger/aorsf?branch=master) [![R-CMD-check](https://github.com/bcjaeger/aorsf/workflows/R-CMD-check/badge.svg)](https://github.com/ropensci/aorsf/actions/) [![Status at rOpenSci Software Peer Review](https://camo.githubusercontent.com/f9d877b91588e502cd9166f649c7b203d81a766a53d391531d227fd13cd56474/68747470733a2f2f6261646765732e726f70656e7363692e6f72672f3533325f7374617475732e737667)](https://github.com/ropensci/software-review/issues/532/) [![](https://camo.githubusercontent.com/9a4b3a7d04a8436871447bca784a1f25177ef7a0d9131a53d80a95a826a6699a/68747470733a2f2f6a6f73732e7468656f6a2e6f72672f7061706572732f31302e32313130352f6a6f73732e30343730352f7374617475732e737667)](https://joss.theoj.org/papers/10.21105/joss.04705) [![CRAN status](https://camo.githubusercontent.com/7cf3abd26e11df7ed2e438e46debf3a1aebfe3ecd3b7b6502265a0bf608306f2/68747470733a2f2f7777772e722d706b672e6f72672f6261646765732f76657273696f6e2f616f727366)](https://cran.r-project.org/package=aorsf) [![DOI](https://camo.githubusercontent.com/df729b7b5e1419bb6b7246f6fd5ee526d04fa6cd4f7010e4939568f9d32bbe7d/68747470733a2f2f7a656e6f646f2e6f72672f62616467652f3339343331313839372e737667)](https://zenodo.org/doi/10.5281/zenodo.7116854)

Fit, interpret, and make predictions with oblique random forests (RFs).

## Why aorsf?

* Fast and versatile tools for oblique RFs.1
* Accurate predictions.2
* Intuitive design with formula based interface.
* Extensive input checks and informative error messages.
* Compatible with `tidymodels` and `mlr3`

## Installation

You can install `aorsf` from CRAN using

install.packages("aorsf")

You can install the development version of aorsf from[GitHub](https://github.com/) with:

# install.packages("remotes")
remotes::install_github("ropensci/aorsf")

## Get started

library(aorsf)
library(tidyverse)

`aorsf` fits several types of oblique RFs with the `orsf()` function, including classification, regression, and survival RFs.

For classification, we fit an oblique RF to predict penguin species using `penguin` data from the magnificent `palmerpenguins` [R package](https://allisonhorst.github.io/palmerpenguins/)

# An oblique classification RF
penguin_fit <- orsf(data = penguins_orsf,
                    n_tree = 5, 
                    formula = species ~ .)

penguin_fit
#> ---------- Oblique random classification forest
#> 
#>      Linear combinations: Accelerated Logistic regression
#>           N observations: 333
#>                N classes: 3
#>                  N trees: 5
#>       N predictors total: 7
#>    N predictors per node: 3
#>  Average leaves per tree: 6
#> Min observations in leaf: 5
#>           OOB stat value: 0.99
#>            OOB stat type: AUC-ROC
#>      Variable importance: anova
#> 
#> -----------------------------------------

For regression, we use the same data but predict bill length of penguins:

# An oblique regression RF
bill_fit <- orsf(data = penguins_orsf, 
                 n_tree = 5, 
                 formula = bill_length_mm ~ .)

bill_fit
#> ---------- Oblique random regression forest
#> 
#>      Linear combinations: Accelerated Linear regression
#>           N observations: 333
#>                  N trees: 5
#>       N predictors total: 7
#>    N predictors per node: 3
#>  Average leaves per tree: 42.6
#> Min observations in leaf: 5
#>           OOB stat value: 0.76
#>            OOB stat type: RSQ
#>      Variable importance: anova
#> 
#> -----------------------------------------

My personal favorite is the oblique survival RF with accelerated Cox regression because it was the first type of oblique RF that `aorsf`provided (see [JCGS paper](https://doi.org/10.1080/10618600.2023.2231048)). Here, we use it to predict mortality risk following diagnosis of primary biliary cirrhosis:

# An oblique survival RF
pbc_fit <- orsf(data = pbc_orsf, 
                n_tree = 5,
                formula = Surv(time, status) ~ . - id)

pbc_fit
#> ---------- Oblique random survival forest
#> 
#>      Linear combinations: Accelerated Cox regression
#>           N observations: 276
#>                 N events: 111
#>                  N trees: 5
#>       N predictors total: 17
#>    N predictors per node: 5
#>  Average leaves per tree: 20.4
#> Min observations in leaf: 5
#>       Min events in leaf: 1
#>           OOB stat value: 0.79
#>            OOB stat type: Harrell's C-index
#>      Variable importance: anova
#> 
#> -----------------------------------------

## What does “oblique” mean?

Decision trees are grown by splitting a set of training data into non-overlapping subsets, with the goal of having more similarity within the new subsets than between them. When subsets are created with a single predictor, the decision tree is _axis-based_ because the subset boundaries are perpendicular to the axis of the predictor. When linear combinations (i.e., a weighted sum) of variables are used instead of a single variable, the tree is _oblique_ because the boundaries are neither parallel nor perpendicular to the axis.

**Figure**: Decision trees for classification with axis-based splitting (left) and oblique splitting (right). Cases are orange squares; controls are purple circles. Both trees partition the predictor space defined by variables X1 and X2, but the oblique splits do a better job of separating the two classes.

[![](https://github.com/ropensci/aorsf/raw/main/man/figures/tree_axis_v_oblique.png)](https://github.com/ropensci/aorsf/blob/main/man/figures/tree%5Faxis%5Fv%5Foblique.png)

So, how does this difference translate to real data, and how does it impact random forests comprising hundreds of axis-based or oblique trees? We will demonstrate this using the `penguin` data.3 We will also use this function to make several plots:

plot_decision_surface <- function(predictions, title, grid){
 
 # this is not a general function for plotting
 # decision surfaces. It just helps to minimize 
 # copying and pasting of code.
 
 class_preds <- bind_cols(grid, predictions) %>%
  pivot_longer(cols = c(Adelie,
                        Chinstrap,
                        Gentoo)) %>%
  group_by(flipper_length_mm, bill_length_mm) %>%
  arrange(desc(value)) %>%
  slice(1)
 
 cols <- c("darkorange", "purple", "cyan4")

 ggplot(class_preds, aes(bill_length_mm, flipper_length_mm)) +
  geom_contour_filled(aes(z = value, fill = name),
                      alpha = .25) +
  geom_point(data = penguins_orsf,
             aes(color = species, shape = species),
             alpha = 0.5) +
  scale_color_manual(values = cols) +
  scale_fill_manual(values = cols) +
  labs(x = "Bill length, mm",
       y = "Flipper length, mm") +
  theme_minimal() +
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  theme(panel.grid = element_blank(),
        panel.border = element_rect(fill = NA),
        legend.position = '') + 
  labs(title = title)
 
}

We also use a grid of points for plotting decision surfaces:

grid <- expand_grid(

 flipper_length_mm = seq(min(penguins_orsf$flipper_length_mm),
                     max(penguins_orsf$flipper_length_mm),
                  len = 200),
 bill_length_mm = seq(min(penguins_orsf$bill_length_mm),
                      max(penguins_orsf$bill_length_mm),
                      len = 200)
)

We use `orsf` with `mtry=1` to fit axis-based trees:

fit_axis_tree <- penguins_orsf %>% 
 orsf(species ~ bill_length_mm + flipper_length_mm,
      n_tree = 1,
      mtry = 1,
      tree_seeds = 106760)

Next we use `orsf_update` to copy and modify the original model, expanding it to fit an oblique tree by using `mtry=2` instead of`mtry=1`, and to include 500 trees instead of 1:

fit_axis_forest <- fit_axis_tree %>% 
 orsf_update(n_tree = 500)

fit_oblique_tree <- fit_axis_tree %>% 
 orsf_update(mtry = 2)

fit_oblique_forest <- fit_oblique_tree %>% 
 orsf_update(n_tree = 500)

And now we have all we need to visualize decision surfaces using predictions from these four fits:

preds <- list(fit_axis_tree,
              fit_axis_forest,
              fit_oblique_tree,
              fit_oblique_forest) %>% 
 map(predict, new_data = grid, pred_type = 'prob')

titles <- c("Axis-based tree",
            "Axis-based forest",
            "Oblique tree",
            "Oblique forest")

plots <- map2(preds, titles, plot_decision_surface, grid = grid)

**Figure**: Axis-based and oblique decision surfaces from a single tree and an ensemble of 500 trees. Axis-based trees have boundaries perpendicular to predictor axes, whereas oblique trees can have boundaries that are neither parallel nor perpendicular to predictor axes. Axis-based forests tend to have ‘step-function’ decision boundaries, while oblique forests tend to have smooth decision boundaries.

[![](https://github.com/ropensci/aorsf/raw/main/man/figures/README-unnamed-chunk-9-1.png)](https://github.com/ropensci/aorsf/blob/main/man/figures/README-unnamed-chunk-9-1.png)

## Variable importance

The importance of individual predictor variables can be estimated in three ways using `aorsf` and can be used on any type of oblique RF. Also, variable importance functions always return a named character vector

* **negation**2: Each variable is assessed separately by multiplying the variable’s coefficients by -1 and then determining how much the model’s performance changes. The worse the model’s performance after negating coefficients for a given variable, the more important the variable. This technique is promising b/c it does not require permutation and it emphasizes variables with larger coefficients in linear combinations, but it is also relatively new and hasn’t been studied as much as permutation importance. See Jaeger, (2023) for more details on this technique.  
orsf_vi_negate(pbc_fit)  
#>          bili        copper         stage           sex           age  
#>  0.1552460736  0.1156218837  0.0796917628  0.0533427094  0.0283132385  
#>       albumin           trt          chol      alk.phos      platelet  
#>  0.0279823814  0.0168238416  0.0153010749  0.0148718669  0.0094582765  
#>         edema       ascites       spiders       protime        hepato  
#>  0.0067975986  0.0065505801  0.0062356214 -0.0004653046 -0.0026664147  
#>           ast          trig  
#> -0.0028902524 -0.0106616501
* **permutation**: Each variable is assessed separately by randomly permuting the variable’s values and then determining how much the model’s performance changes. The worse the model’s performance after permuting the values of a given variable, the more important the variable. This technique is flexible, intuitive, and frequently used. It also has several [known limitations](https://christophm.github.io/interpretable-ml-book/feature-importance.html#disadvantages-9)  
orsf_vi_permute(penguin_fit)  
#>    bill_length_mm     bill_depth_mm       body_mass_g            island  
#>       0.121351910       0.101846889       0.097822451       0.080772909  
#>               sex flipper_length_mm              year  
#>       0.035053517       0.008270751      -0.008058339
* **analysis of variance (ANOVA)**4: A p-value is computed for each coefficient in each linear combination of variables in each decision tree. Importance for an individual predictor variable is the proportion of times a p-value for its coefficient is < 0.01\. This technique is very efficient computationally, but may not be as effective as permutation or negation in terms of selecting signal over noise variables. See [Menze, 2011](https://link.springer.com/chapter/10.1007/978-3-642-23783-6%5F29)for more details on this technique.  
orsf_vi_anova(bill_fit)  
#>           species               sex     bill_depth_mm flipper_length_mm  
#>        0.51652893        0.27906977        0.06315789        0.04950495  
#>       body_mass_g            island              year  
#>        0.04807692        0.02687148        0.00000000

You can supply your own R function to estimate out-of-bag error (see[oob vignette](https://docs.ropensci.org/aorsf/articles/oobag.html)) or to estimate out-of-bag variable importance (see [orsf\_vi examples](https://docs.ropensci.org/aorsf/reference/orsf%5Fvi.html#examples))

## Partial dependence (PD)

Partial dependence (PD) shows the expected prediction from a model as a function of a single predictor or multiple predictors. The expectation is marginalized over the values of all other predictors, giving something like a multivariable adjusted estimate of the model’s prediction.. You can use specific values for a predictor to compute PD or let `aorsf` pick reasonable values for you if you use`pred_spec_auto()`:

# pick your own values
orsf_pd_oob(bill_fit, pred_spec = list(species = c("Adelie", "Gentoo")))
#>    species     mean      lwr     medn      upr
#>     <fctr>    <num>    <num>    <num>    <num>
#> 1:  Adelie 39.99394 35.76532 39.80782 46.13931
#> 2:  Gentoo 46.66565 40.02938 46.88517 51.61367

# let aorsf pick reasonable values for you:
orsf_pd_oob(bill_fit, pred_spec = pred_spec_auto(bill_depth_mm, island))
#>     bill_depth_mm    island     mean      lwr     medn      upr
#>             <num>    <fctr>    <num>    <num>    <num>    <num>
#>  1:          14.3    Biscoe 43.94960 35.90421 45.30159 51.05109
#>  2:          15.6    Biscoe 44.24705 36.62759 45.57321 51.08020
#>  3:          17.3    Biscoe 44.84757 36.53804 45.62910 53.93833
#>  4:          18.7    Biscoe 45.08939 36.35893 46.16893 54.42075
#>  5:          19.5    Biscoe 45.13608 36.21033 46.08023 54.42075
#> ---                                                            
#> 11:          14.3 Torgersen 43.55984 35.47143 44.18127 51.05109
#> 12:          15.6 Torgersen 43.77317 35.44683 44.28406 51.08020
#> 13:          17.3 Torgersen 44.56465 35.84585 44.83694 53.93833
#> 14:          18.7 Torgersen 44.68367 35.44010 44.86667 54.42075
#> 15:          19.5 Torgersen 44.64605 35.44010 44.86667 54.42075

The summary function, `orsf_summarize_uni()`, computes PD for as many variables as you ask it to, using sensible values.

orsf_summarize_uni(pbc_fit, n_variables = 2)
#> 
#> -- bili (VI Rank: 1) -----------------------------
#> 
#>         |----------------- Risk -----------------|
#>   Value      Mean     Median     25th %    75th %
#>  <char>     <num>      <num>      <num>     <num>
#>    0.60 0.2098108 0.07168855 0.01138461 0.2860450
#>    0.80 0.2117933 0.07692308 0.01709469 0.2884990
#>    1.40 0.2326560 0.08445419 0.02100837 0.3563622
#>    3.55 0.4265979 0.35820106 0.05128824 0.7342923
#>    7.30 0.4724608 0.44746241 0.11759259 0.8039683
#> 
#> -- copper (VI Rank: 2) ---------------------------
#> 
#>         |----------------- Risk -----------------|
#>   Value      Mean     Median     25th %    75th %
#>  <char>     <num>      <num>      <num>     <num>
#>    25.0 0.2332412 0.04425936 0.01587919 0.3888304
#>    42.5 0.2535448 0.07417582 0.01754386 0.4151786
#>    74.0 0.2825471 0.11111111 0.01988069 0.4770833
#>     130 0.3259604 0.18771003 0.04658385 0.5054348
#>     217 0.4213303 0.28571429 0.13345865 0.6859423
#> 
#>  Predicted risk at time t = 1788 for top 2 predictors

For more on PD, see the[vignette](https://docs.ropensci.org/aorsf/articles/pd.html)

## Individual conditional expectations (ICE)

Unlike partial dependence, which shows the expected prediction as a function of one or multiple predictors, individual conditional expectations (ICE) show the prediction for an individual observation as a function of a predictor.

For more on ICE, see the[vignette](https://docs.ropensci.org/aorsf/articles/pd.html#individual-conditional-expectations-ice)

## Interaction scores

The `orsf_vint()` function computes a score for each possible interaction in a model based on PD using the method described in Greenwell et al, 2018.5 It can be slow for larger datasets, but substantial speedups occur by making use of multi-threading and restricting the search to a smaller set of predictors.

preds_interaction <- c("albumin", "protime", "bili", "spiders", "trt")

# While it is tempting to speed up `orsf_vint()` by growing a smaller 
# number of trees, results may become unstable with this shortcut.
pbc_interactions <- pbc_fit %>% 
 orsf_update(n_tree = 500, tree_seeds = 329) %>% 
 orsf_vint(n_thread = 0,  predictors = preds_interaction)

pbc_interactions
#>          interaction      score
#>               <char>      <num>
#>  1: albumin..protime 0.97837184
#>  2:    protime..bili 0.78999788
#>  3:    albumin..bili 0.59128756
#>  4:    bili..spiders 0.13192184
#>  5:        bili..trt 0.13192184
#>  6: albumin..spiders 0.06578222
#>  7:     albumin..trt 0.06578222
#>  8: protime..spiders 0.03012718
#>  9:     protime..trt 0.03012718
#> 10:     spiders..trt 0.00000000

What do the values in `score` mean? These values are the average of the standard deviation of the standard deviation of PD in one variable conditional on the other variable. They should be interpreted relative to one another, i.e., a higher scoring interaction is more likely to reflect a real interaction between two variables than a lower scoring one.

Do these interaction scores make sense? Let’s test the top scoring and lowest scoring interactions using `coxph()`.

library(survival)
# the top scoring interaction should get a lower p-value
anova(coxph(Surv(time, status) ~ protime * albumin, data = pbc_orsf))
#> Analysis of Deviance Table
#>  Cox model: response is Surv(time, status)
#> Terms added sequentially (first to last)
#> 
#>                  loglik  Chisq Df Pr(>|Chi|)    
#> NULL            -550.19                         
#> protime         -538.51 23.353  1  1.349e-06 ***
#> albumin         -514.89 47.255  1  6.234e-12 ***
#> protime:albumin -511.76  6.252  1    0.01241 *  
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# the bottom scoring interaction should get a higher p-value
anova(coxph(Surv(time, status) ~ spiders * trt, data = pbc_orsf))
#> Analysis of Deviance Table
#>  Cox model: response is Surv(time, status)
#> Terms added sequentially (first to last)
#> 
#>              loglik   Chisq Df Pr(>|Chi|)    
#> NULL        -550.19                          
#> spiders     -538.58 23.2159  1  1.448e-06 ***
#> trt         -538.39  0.3877  1     0.5335    
#> spiders:trt -538.29  0.2066  1     0.6494    
#> ---
#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Note: this is exploratory and not a true null hypothesis test. Why? Because we used the same data both to generate and to test the null hypothesis. We are not so much conducting statistical inference when we test these interactions with `coxph` as we are demonstrating the interaction scores that `orsf_vint()` provides are consistent with tests from other models.

## Comparison to existing software

For survival analysis, comparisons between `aorsf` and existing software are presented in our [JCGS paper](https://doi.org/10.1080/10618600.2023.2231048). The paper:

* describes `aorsf` in detail with a summary of the procedures used in the tree fitting algorithm
* runs a general benchmark comparing `aorsf` with `obliqueRSF` and several other learners
* reports prediction accuracy and computational efficiency of all learners.
* runs a simulation study comparing variable importance techniques with oblique survival RFs, axis based survival RFs, and boosted trees.
* reports the probability that each variable importance technique will rank a relevant variable with higher importance than an irrelevant variable.

## References

1. Jaeger BC, Long DL, Long DM, Sims M, Szychowski JM, Min Y, Mcclure LA, Howard G, Simon N (2019). “Oblique random survival forests.”_The Annals of Applied Statistics_, _13_(3). doi:10.1214/19-aoas1261 <https://doi.org/10.1214/19-aoas1261>.
2. Jaeger BC, Welden S, Lenoir K, Speiser JL, Segar MW, Pandey A, Pajewski NM (2023). “Accelerated and interpretable oblique random survival forests.” _Journal of Computational and Graphical Statistics_, 1-16\. doi:10.1080/10618600.2023.2231048<https://doi.org/10.1080/10618600.2023.2231048>.
3. Horst AM, Hill AP, Gorman KB (2020). _palmerpenguins: Palmer Archipelago (Antarctica) penguin data_. R package version 0.1.0,<https://allisonhorst.github.io/palmerpenguins/>.
4. Menze, H B, Kelm, Michael B, Splitthoff, N D, Koethe, Ullrich, Hamprecht, A F (2011). “On oblique random forests.” In _Machine Learning and Knowledge Discovery in Databases: European Conference, ECML PKDD 2011, Athens, Greece, September 5-9, 2011, Proceedings, Part II 22_, 453-469\. Springer.
5. Greenwell, M B, Boehmke, C B, McCarthy, J A (2018). “A simple and effective model-based variable importance measure.” _arXiv preprint arXiv:1805.04755_.

## Funding

The developers of `aorsf` received financial support from the Center for Biomedical Informatics, Wake Forest University School of Medicine. We also received support from the National Center for Advancing Translational Sciences of the National Institutes of Health under Award Number UL1TR001420.

The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.

## About

 Accelerated Oblique Random Survival Forests

[docs.ropensci.org/aorsf](https://docs.ropensci.org/aorsf "https://docs.ropensci.org/aorsf") 

### Topics

[ data-science](https://github.com/topics/data-science "Topic: data-science") [ random-forest](https://github.com/topics/random-forest "Topic: random-forest") [ rstats](https://github.com/topics/rstats "Topic: rstats") [ survival](https://github.com/topics/survival "Topic: survival") [ oblique](https://github.com/topics/oblique "Topic: oblique") 

### Resources

[  Readme](https://github.com/ropensci/aorsf#readme-ov-file) 

### License

 Unknown, MIT licenses found 

### Licenses found

[ Unknown LICENSE ](https://github.com/ropensci/aorsf/blob/main/LICENSE) [ MIT LICENSE.md ](https://github.com/ropensci/aorsf/blob/main/LICENSE.md) 

### Code of conduct

[  Code of conduct](https://github.com/ropensci/aorsf#coc-ov-file) 

[ Activity](https://github.com/ropensci/aorsf/activity) 

[ Custom properties](https://github.com/ropensci/aorsf/custom-properties) 

### Stars

[ **58** stars](https://github.com/ropensci/aorsf/stargazers) 

### Watchers

[ **3** watching](https://github.com/ropensci/aorsf/watchers) 

### Forks

[ **11** forks](https://github.com/ropensci/aorsf/forks) 

[ Report repository](https://github.com/contact/report-content?content%5Furl=https%3A%2F%2Fgithub.com%2Fropensci%2Faorsf&report=ropensci+%28user%29) 

## [Releases5](https://github.com/ropensci/aorsf/releases)

[ Classification and regression  Latest Jan 22, 2024 ](https://github.com/ropensci/aorsf/releases/tag/v0.1.3) 

[\+ 4 releases](https://github.com/ropensci/aorsf/releases)

## [Packages0](https://github.com/orgs/ropensci/packages?repo%5Fname=aorsf)

 No packages published   

## [Contributors6](https://github.com/ropensci/aorsf/graphs/contributors)

## Languages

* [ R 65.8% ](https://github.com/ropensci/aorsf/search?l=r)
* [ C++ 33.7% ](https://github.com/ropensci/aorsf/search?l=c%2B%2B)
* [ TeX 0.5% ](https://github.com/ropensci/aorsf/search?l=tex)

 You can’t perform that action at this time.
